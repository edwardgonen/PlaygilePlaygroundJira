<div class="mod-header">
    <h3>$i18n.getText('metrics--page--item.label')</h3>
    <!--img style="-webkit-user-select: none" src="https://chart.googleapis.com/chart?cht=p&chs=380x200&chd=t:41,55,4&chl=41%|55%|4%&chdl=Cash|Credit_Card|Check&chco=26AD21|1D82C4|F0A016"-->
    <html>
    <head>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script type="text/javascript">

            google.charts.load('current', {'packages':['corechart']});
            google.charts.setOnLoadCallback(drawChart);

            function drawChart() {
                const LINE_SEPARATOR = ",";
                const PAIR_SEPARATOR = "|";
                const DATE_FORMAT = "MM/dd/yyyy";

                var data = new google.visualization.DataTable();
                data.addColumn('date', 'Date');
                data.addColumn('number', 'Ideal');
                data.addColumn('number', 'Predicted');

                var chartRows = '$chartrows';
                //split and parse
                if (typeof chartRows === 'undefined' || chartRows === null)
                {
                    alert("No rows for the chart");
                    return;
                }

                var lines = chartRows.split(LINE_SEPARATOR);
                if (lines.length <= 0)
                {
                    alert("Wrong rows format " + chartRows);
                    return;
                }
                lines.forEach(function (line, index) {
                    if (line.length > 0)//non empty line
                    {
                        //split by pair separator
                        var items = line.split(PAIR_SEPARATOR);
                        if (items.length < 3)
                        {
                            alert("Wrong line format " + line);
                        }

                        var date = new Date(items[0]);

                        var ideal = parseFloat(items[1]);
                        if (isNaN(ideal)) ideal = null;

                        var predicted = parseFloat(items[2]);
                        if (isNaN(predicted)) predicted = null;

                        data.addRow([date, ideal, predicted]);
                        //data.addRow([new Date(2010, 1, 1),  37.8, 80.8]);
                    }
                });
                var options = {
                    title: 'Project Monitor ',
                    curveType: 'function',
                    legend: { position: 'bottom' }
                };

                var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));

                chart.draw(data, options);

            }
        </script>
    </head>
    <body>
    <div id="curve_chart" style="width: 900px; height: 500px"></div>
    </body>
    </html>
    <input type="hidden" id="project" name="project" value="$project">
    <table>
        <tr>
            <td>Name</td><td>$project.name</td>
        </tr>
        <tr>
            <td>Key</td><td>$project.key</td>
        </tr>
        <tr>
            <td>Active Object result</td><td>$aoresult</td>
        </tr>
        <tr>
            <td>Project Lead Key</td><td>$project.lead.key</td>
        </tr>
        <tr>
            <td>Project Lead Name</td><td>$project.lead.name</td>
        </tr>
        <tr>
            <td>Status text</td><td>$statustext</td>
        </tr>
        <tr>
            <td>Project Lead Email Address</td><td>$project.lead.emailAddress</td>
        </tr>
        <tr>
            <td>Issue info</td>
            <td>
                $issue.getSummary()
            </td>
            <td>
                $issue.getStatusObject().getName()
            </td>
            <td>
                $issue.getId()
            </td>
            <td>
                $storypoints
            </td>
        </tr>
    </table>
</div>
